import numpy as np
from scipy.interpolate import Rbf


def _calc_svn21_degas():
    """ Calculates cross section for "Neutral n=2 / n=1," whatever that is.

    accepts ne in m^-3 and Te in eV
    results in erg/s, i.e. units of power.
    """

    # populate the 15x60 array to be used for interpolations
    # rows correspond to ne, columns correspond to Te

    n21_data = np.zeros((15, 60))
    n21_data[0] = np.array([8.46420E-76, 2.10374E-61, 5.58965E-50, 6.48365E-41, 1.00386E-33, 5.04074E-28,
                            1.66168E-23, 6.29701E-20, 4.28132E-17, 7.43919E-15, 4.37615E-13, 1.08966E-11,
                            1.37128E-10, 1.00381E-09, 4.77792E-09, 1.61519E-08, 4.15912E-08, 8.62387E-08,
                            1.50492E-07, 2.28926E-07, 3.31018E-07, 4.46452E-07, 5.62111E-07, 6.69822E-07,
                            7.63971E-07, 8.41529E-07, 9.01643E-07, 9.45015E-07, 9.73291E-07, 9.88568E-07,
                            9.93047E-07, 9.88823E-07, 9.77768E-07, 9.61488E-07, 9.41323E-07, 9.18359E-07,
                            8.93466E-07, 8.67328E-07, 8.40477E-07, 8.13320E-07, 7.86168E-07, 7.59252E-07,
                            7.32744E-07, 6.66474E-07, 6.26529E-07, 5.88188E-07, 5.50699E-07, 5.14348E-07,
                            4.79346E-07, 4.45840E-07, 4.13927E-07, 3.83663E-07, 3.55072E-07, 3.28151E-07,
                            3.02878E-07, 2.79215E-07, 2.57113E-07, 2.36512E-07, 2.17348E-07, 1.99553E-07])
    n21_data[0] = np.array([2.67659E-75, 6.65255E-61, 1.76759E-49, 2.05030E-40, 3.17446E-33, 1.59401E-27,
                            5.25467E-23, 1.99128E-19, 1.35387E-16, 2.35245E-14, 1.38382E-12, 3.44558E-11,
                            4.33571E-10, 3.17341E-09, 1.51020E-08, 5.10412E-08, 1.31398E-07, 2.72382E-07,
                            4.75204E-07, 7.22710E-07, 1.04491E-06, 1.40915E-06, 1.77399E-06, 2.11373E-06,
                            2.41067E-06, 2.65528E-06, 2.84488E-06, 2.98169E-06, 3.07091E-06, 3.11914E-06,
                            3.13333E-06, 3.12008E-06, 3.08528E-06, 3.03401E-06, 2.97048E-06, 2.89813E-06,
                            2.81968E-06, 2.73730E-06, 2.65266E-06, 2.56705E-06, 2.48146E-06, 2.39660E-06,
                            2.31302E-06, 2.10370E-06, 1.97782E-06, 1.85686E-06, 1.73858E-06, 1.62388E-06,
                            1.51344E-06, 1.40772E-06, 1.30701E-06, 1.21151E-06, 1.12128E-06, 1.03631E-06,
                            9.56547E-07, 8.81859E-07, 8.12092E-07, 7.47062E-07, 6.86566E-07, 6.30389E-07])
    n21_data[0] = np.array([8.46393E-75, 2.10368E-60, 5.58951E-49, 6.48350E-40, 1.00384E-32, 5.04065E-27,
                            1.66165E-22, 6.29691E-19, 4.28125E-16, 7.43895E-14, 4.37581E-12, 1.08946E-10,
                            1.37074E-09, 1.00307E-08, 4.77225E-08, 1.61238E-07, 4.14936E-07, 8.59826E-07,
                            1.49954E-06, 2.27984E-06, 3.29581E-06, 4.44396E-06, 5.59354E-06, 6.66399E-06,
                            7.59941E-06, 8.37010E-06, 8.96748E-06, 9.39867E-06, 9.67999E-06, 9.83226E-06,
                            9.87733E-06, 9.83597E-06, 9.72676E-06, 9.56564E-06, 9.36588E-06, 9.13830E-06,
                            8.89148E-06, 8.63224E-06, 8.36585E-06, 8.09637E-06, 7.82688E-06, 7.55968E-06,
                            7.29648E-06, 6.63562E-06, 6.23943E-06, 5.85812E-06, 5.48524E-06, 5.12364E-06,
                            4.77542E-06, 4.44204E-06, 4.12447E-06, 3.82328E-06, 3.53870E-06, 3.27073E-06,
                            3.01913E-06, 2.78353E-06, 2.56345E-06, 2.35829E-06, 2.16744E-06, 1.99019E-06])
    n21_data[0] = np.array([2.67632E-74, 6.65194E-60, 1.76745E-48, 2.05015E-39, 3.17426E-32, 1.59392E-26,
                            5.25440E-22, 1.99118E-18, 1.35380E-15, 2.35227E-13, 1.38360E-11, 3.44440E-10,
                            4.33279E-09, 3.16963E-08, 1.50736E-07, 5.09032E-07, 1.30925E-06, 2.71155E-06,
                            4.72652E-06, 7.18263E-06, 1.03815E-05, 1.39946E-05, 1.76103E-05, 2.09767E-05,
                            2.39179E-05, 2.63419E-05, 2.82208E-05, 2.95779E-05, 3.04640E-05, 3.09447E-05,
                            3.10885E-05, 3.09608E-05, 3.06197E-05, 3.01153E-05, 2.94893E-05, 2.87758E-05,
                            2.80015E-05, 2.71880E-05, 2.63518E-05, 2.55056E-05, 2.46592E-05, 2.38198E-05,
                            2.29927E-05, 2.09081E-05, 1.96639E-05, 1.84637E-05, 1.72899E-05, 1.61514E-05,
                            1.50549E-05, 1.40049E-05, 1.30047E-05, 1.20559E-05, 1.11593E-05, 1.03150E-05,
                            9.52216E-06, 8.77968E-06, 8.08602E-06, 7.43937E-06, 6.83772E-06, 6.27894E-06])
    n21_data[0] = np.array([8.46116E-74, 2.10306E-59, 5.58806E-48, 6.48200E-39, 1.00363E-31, 5.03972E-26,
                            1.66138E-21, 6.29594E-18, 4.28057E-15, 7.43738E-13, 4.37421E-11, 1.08870E-09,
                            1.36900E-08, 1.00094E-07, 4.75675E-07, 1.60504E-06, 4.12465E-06, 8.53510E-06,
                            1.48657E-05, 2.25745E-05, 3.26189E-05, 4.39541E-05, 5.52901E-05, 6.58412E-05,
                            7.50585E-05, 8.26579E-05, 8.85489E-05, 9.28112E-05, 9.55972E-05, 9.71154E-05,
                            9.75788E-05, 9.71926E-05, 9.61373E-05, 9.45699E-05, 9.26206E-05, 9.03975E-05,
                            8.79817E-05, 8.54423E-05, 8.28302E-05, 8.01855E-05, 7.75388E-05, 7.49128E-05,
                            7.23245E-05, 6.57598E-05, 6.18674E-05, 5.81001E-05, 5.44144E-05, 5.08387E-05,
                            4.73937E-05, 4.40944E-05, 4.09504E-05, 3.79675E-05, 3.51483E-05, 3.24927E-05,
                            2.99986E-05, 2.76625E-05, 2.54796E-05, 2.34443E-05, 2.15504E-05, 1.97912E-05])
    n21_data[0] = np.array([2.67355E-73, 6.64581E-59, 1.76600E-47, 2.04865E-38, 3.17218E-31, 1.59299E-25,
                            5.25165E-21, 1.99022E-17, 1.35313E-14, 2.35084E-12, 1.38231E-10, 3.43891E-09,
                            4.32118E-08, 3.15613E-07, 1.49794E-06, 5.04696E-06, 1.29500E-05, 2.67576E-05,
                            4.65409E-05, 7.05917E-05, 1.01948E-04, 1.37283E-04, 1.72593E-04, 2.05447E-04,
                            2.34149E-04, 2.57824E-04, 2.76190E-04, 2.89519E-04, 2.98253E-04, 3.03053E-04,
                            3.04574E-04, 3.03472E-04, 3.00276E-04, 2.95482E-04, 2.89494E-04, 2.82662E-04,
                            2.75212E-04, 2.67375E-04, 2.59299E-04, 2.51113E-04, 2.42913E-04, 2.34769E-04,
                            2.26735E-04, 2.06140E-04, 1.94048E-04, 1.82285E-04, 1.70769E-04, 1.59591E-04,
                            1.48816E-04, 1.38491E-04, 1.28648E-04, 1.19305E-04, 1.10470E-04, 1.02146E-04,
                            9.43247E-05, 8.69964E-05, 8.01466E-05, 7.37579E-05, 6.78111E-05, 6.22858E-05])
    n21_data[0] = np.array([8.43356E-73, 2.09695E-58, 5.57357E-47, 6.46701E-38, 1.00156E-30, 5.03045E-25,
                            1.65864E-20, 6.28636E-17, 4.27401E-14, 7.42378E-12, 4.36270E-10, 1.08419E-08,
                            1.36010E-07, 9.91123E-07, 4.69101E-06, 1.57574E-05, 4.03078E-05, 8.30431E-05,
                            1.44066E-04, 2.18033E-04, 3.14528E-04, 4.23008E-04, 5.31321E-04, 6.32096E-04,
                            7.20204E-04, 7.92984E-04, 8.49602E-04, 8.90904E-04, 9.18177E-04, 9.33446E-04,
                            9.38683E-04, 9.36095E-04, 9.26950E-04, 9.12869E-04, 8.95081E-04, 8.74817E-04,
                            8.52489E-04, 8.28970E-04, 8.04624E-04, 7.79869E-04, 7.55008E-04, 7.30261E-04,
                            7.05796E-04, 6.41816E-04, 6.04764E-04, 5.68466E-04, 5.32879E-04, 4.98288E-04,
                            4.64903E-04, 4.32877E-04, 4.02313E-04, 3.73274E-04, 3.45792E-04, 3.19873E-04,
                            2.95503E-04, 2.72651E-04, 2.51277E-04, 2.31328E-04, 2.12748E-04, 1.95475E-04])
    n21_data[0] = np.array([2.64619E-72, 6.58512E-58, 1.75161E-46, 2.03376E-37, 3.15161E-30, 1.58377E-24,
                            5.22437E-20, 1.98069E-16, 1.34663E-13, 2.33749E-11, 1.37135E-09, 3.39802E-08,
                            4.24498E-07, 3.07584E-06, 1.44622E-05, 4.82384E-05, 1.22541E-04, 2.50845E-04,
                            4.32737E-04, 6.51881E-04, 9.37689E-04, 1.25783E-03, 1.57720E-03, 1.87461E-03,
                            2.13537E-03, 2.35180E-03, 2.52152E-03, 2.64686E-03, 2.73141E-03, 2.78090E-03,
                            2.80092E-03, 2.79895E-03, 2.77687E-03, 2.73996E-03, 2.69178E-03, 2.63786E-03,
                            2.57612E-03, 2.51103E-03, 2.44267E-03, 2.37255E-03, 2.30163E-03, 2.23058E-03,
                            2.15991E-03, 1.96662E-03, 1.85672E-03, 1.74807E-03, 1.64111E-03, 1.53677E-03,
                            1.43574E-03, 1.33853E-03, 1.24550E-03, 1.15690E-03, 1.07285E-03, 9.93418E-04,
                            9.18586E-04, 8.48293E-04, 7.82433E-04, 7.20874E-04, 6.63457E-04, 6.10007E-04])
    n21_data[0] = np.array([8.16718E-72, 2.03769E-57, 5.43271E-46, 6.32091E-37, 9.81339E-30, 4.93965E-24,
                            1.63175E-19, 6.19248E-16, 4.20988E-13, 7.29225E-11, 4.25665E-09, 1.04603E-07,
                            1.29217E-06, 9.22441E-06, 4.26516E-05, 1.39820E-04, 3.49348E-04, 7.04559E-04,
                            1.20018E-03, 1.78971E-03, 2.55602E-03, 3.41031E-03, 4.26222E-03, 5.05852E-03,
                            5.76246E-03, 6.35457E-03, 6.82838E-03, 7.18909E-03, 7.44479E-03, 7.60918E-03,
                            7.69574E-03, 7.72591E-03, 7.69981E-03, 7.63226E-03, 7.53234E-03, 7.43346E-03,
                            7.29892E-03, 7.15777E-03, 7.00195E-03, 6.83778E-03, 6.66826E-03, 6.49519E-03,
                            6.32007E-03, 5.77885E-03, 5.48100E-03, 5.18193E-03, 4.88426E-03, 4.59097E-03,
                            4.30440E-03, 4.02641E-03, 3.75837E-03, 3.50132E-03, 3.25594E-03, 3.02267E-03,
                            2.80173E-03, 2.59316E-03, 2.39685E-03, 2.21259E-03, 2.04006E-03, 1.87888E-03])
    n21_data[0] = np.array([2.40052E-71, 6.03407E-57, 1.61964E-45, 1.89594E-36, 2.95969E-29, 1.49715E-23,
                            4.96686E-19, 1.89053E-15, 1.28495E-12, 2.21164E-10, 1.27205E-08, 3.05415E-07,
                            3.66153E-06, 2.51624E-05, 1.11735E-04, 3.52102E-04, 8.48885E-04, 1.66061E-03,
                            2.75963E-03, 4.03739E-03, 5.68707E-03, 7.51649E-03, 9.34320E-03, 1.10658E-02,
                            1.26147E-02, 1.39521E-02, 1.50637E-02, 1.59574E-02, 1.66447E-02, 1.71490E-02,
                            1.74933E-02, 1.77251E-02, 1.78307E-02, 1.78421E-02, 1.77764E-02, 1.78161E-02,
                            1.77022E-02, 1.75962E-02, 1.74320E-02, 1.72355E-02, 1.70142E-02, 1.67712E-02,
                            1.65092E-02, 1.52627E-02, 1.46345E-02, 1.39802E-02, 1.33084E-02, 1.26280E-02,
                            1.19465E-02, 1.12704E-02, 1.06051E-02, 9.95493E-03, 9.32356E-03, 8.71381E-03,
                            8.12783E-03, 7.56719E-03, 7.03297E-03, 6.52577E-03, 6.04584E-03, 5.59311E-03])
    n21_data[0] = np.array([6.20673E-71, 1.58873E-56, 4.33674E-45, 5.15603E-36, 8.16483E-29, 4.18456E-23,
                            1.40442E-18, 5.38935E-15, 3.66046E-12, 6.19199E-10, 3.42670E-08, 7.77551E-07,
                            8.72168E-06, 5.55377E-05, 2.29419E-04, 6.78550E-04, 1.55288E-03, 2.91562E-03,
                            4.69636E-03, 6.71547E-03, 9.30805E-03, 1.21730E-02, 1.50424E-02, 1.77786E-02,
                            2.02872E-02, 2.25174E-02, 2.44475E-02, 2.60866E-02, 2.74452E-02, 2.85519E-02,
                            2.94336E-02, 3.01697E-02, 3.07130E-02, 3.11133E-02, 3.13923E-02, 3.21395E-02,
                            3.24766E-02, 3.29280E-02, 3.32517E-02, 3.35203E-02, 3.37484E-02, 3.39349E-02,
                            3.40784E-02, 3.21433E-02, 3.14404E-02, 3.06311E-02, 2.97291E-02, 2.87494E-02,
                            2.77060E-02, 2.66124E-02, 2.54811E-02, 2.43238E-02, 2.31514E-02, 2.19739E-02,
                            2.08003E-02, 1.96388E-02, 1.84964E-02, 1.73795E-02, 1.62933E-02, 1.52422E-02])
    n21_data[0] = np.array([1.24484E-70, 3.28509E-56, 9.23700E-45, 1.13011E-35, 1.83951E-28, 9.67839E-23,
                            3.32751E-18, 1.29942E-14, 8.81194E-12, 1.43695E-09, 7.37870E-08, 1.52103E-06,
                            1.54908E-05, 8.98218E-05, 3.43968E-04, 9.59983E-04, 2.10491E-03, 3.83149E-03,
                            6.03661E-03, 8.49949E-03, 1.16569E-02, 1.51426E-02, 1.86432E-02, 2.20065E-02,
                            2.51289E-02, 2.79551E-02, 3.04609E-02, 3.26576E-02, 3.45536E-02, 3.61803E-02,
                            3.75657E-02, 3.88138E-02, 3.98461E-02, 4.07251E-02, 4.14736E-02, 4.31528E-02,
                            4.41862E-02, 4.55264E-02, 4.67211E-02, 4.79024E-02, 4.90973E-02, 5.03028E-02,
                            5.15146E-02, 4.96000E-02, 4.95555E-02, 4.93478E-02, 4.89833E-02, 4.84708E-02,
                            4.78189E-02, 4.70359E-02, 4.61305E-02, 4.51115E-02, 4.39880E-02, 4.27698E-02,
                            4.14668E-02, 4.00894E-02, 3.86482E-02, 3.71544E-02, 3.56188E-02, 3.40527E-02])
    n21_data[0] = np.array([1.82530E-70, 4.95974E-56, 1.43726E-44, 1.81365E-35, 3.04669E-28, 1.65490E-22,
                            5.86876E-18, 2.34644E-14, 1.58771E-11, 2.46695E-09, 1.16111E-07, 2.17949E-06,
                            2.05204E-05, 1.11557E-04, 4.08231E-04, 1.10428E-03, 2.37009E-03, 4.25166E-03,
                            6.63188E-03, 9.27475E-03, 1.26629E-02, 1.64030E-02, 2.01647E-02, 2.37910E-02,
                            2.71757E-02, 3.02626E-02, 3.30273E-02, 3.54820E-02, 3.76351E-02, 3.95192E-02,
                            4.11628E-02, 4.26828E-02, 4.39848E-02, 4.51382E-02, 4.61664E-02, 4.84038E-02,
                            4.98805E-02, 5.18028E-02, 5.35973E-02, 5.54366E-02, 5.73622E-02, 5.93773E-02,
                            6.14838E-02, 5.99141E-02, 6.06310E-02, 6.12074E-02, 6.16467E-02, 6.19535E-02,
                            6.21316E-02, 6.21836E-02, 6.21117E-02, 6.19175E-02, 6.16023E-02, 6.11671E-02,
                            6.06130E-02, 5.99412E-02, 5.91532E-02, 5.82508E-02, 5.72365E-02, 5.61134E-02])
    n21_data[0] = np.array([2.14100E-70, 5.91293E-56, 1.74386E-44, 2.24259E-35, 3.84451E-28, 2.13395E-22,
                            7.73729E-18, 3.14856E-14, 2.12653E-11, 3.18882E-09, 1.41748E-07, 2.52298E-06,
                            2.28446E-05, 1.20682E-04, 4.33463E-04, 1.15822E-03, 2.46640E-03, 4.40134E-03,
                            6.84149E-03, 9.54454E-03, 1.30112E-02, 1.68371E-02, 2.06882E-02, 2.44053E-02,
                            2.78829E-02, 3.10632E-02, 3.39216E-02, 3.64710E-02, 3.87196E-02, 4.07005E-02,
                            4.24425E-02, 4.40671E-02, 4.54745E-02, 4.67365E-02, 4.78768E-02, 5.03387E-02,
                            5.19979E-02, 5.41629E-02, 5.62128E-02, 5.83380E-02, 6.05880E-02, 6.29706E-02,
                            6.54935E-02, 6.41339E-02, 6.52454E-02, 6.62460E-02, 6.71406E-02, 6.79354E-02,
                            6.86353E-02, 6.92443E-02, 6.97653E-02, 7.02004E-02, 7.05509E-02, 7.08176E-02,
                            7.10004E-02, 7.10989E-02, 7.11122E-02, 7.10389E-02, 7.08775E-02, 7.06260E-02])
    n21_data[0] = np.array([2.26487E-70, 6.29554E-56, 1.87001E-44, 2.42387E-35, 4.19162E-28, 2.34896E-22,
                            8.60330E-18, 3.52979E-14, 2.38103E-11, 3.51084E-09, 1.52228E-07, 2.65124E-06,
                            2.36584E-05, 1.23646E-04, 4.41194E-04, 1.17425E-03, 2.49508E-03, 4.44544E-03,
                            6.90321E-03, 9.62583E-03, 1.31174E-02, 1.69701E-02, 2.08512E-02, 2.45995E-02,
                            2.81043E-02, 3.13150E-02, 3.42013E-02, 3.67816E-02, 3.90612E-02, 4.10761E-02,
                            4.28527E-02, 4.45140E-02, 4.59584E-02, 4.72584E-02, 4.84381E-02, 5.09774E-02,
                            5.27005E-02, 5.49502E-02, 5.70900E-02, 5.93164E-02, 6.16819E-02, 6.41966E-02,
                            6.68704E-02, 6.55930E-02, 6.68529E-02, 6.80155E-02, 6.90869E-02, 7.00745E-02,
                            7.09849E-02, 7.18234E-02, 7.25946E-02, 7.33021E-02, 7.39492E-02, 7.45382E-02,
                            7.50709E-02, 7.55488E-02, 7.59728E-02, 7.63433E-02, 7.66603E-02, 7.69235E-02])

    Te_vals, ne_vals = np.meshgrid(-1.2 + (np.linspace(1, 60, 60) - 1) / 10 - 3,
                                   10 + 0.5 * (np.linspace(1, 15, 15) - 1) + 6)

    return Rbf(Te_vals, ne_vals, n21_data)
