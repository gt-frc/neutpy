import numpy as np
from scipy.interpolate import Rbf


def _calc_svcel_degas():
    """ Calculates cross section for "Continuum Electron Losses," whatever that is.

    accepts ne in m^-3 and Te in eV
    results in erg/s, i.e. units of power.
    """

    # populate the 15x60 array to be used for interpolations
    # rows correspond to ne, columns correspond to Te

    cel_data = np.zeros((15, 60))
    cel_data[0] = np.array([1.12349E-11, 5.51216E-12, 2.94674E-12, 1.70906E-12, 1.06617E-12, 7.08039E-13,
                            4.95378E-13, 3.61651E-13, 2.73200E-13, 2.12056E-13, 1.68146E-13, 1.35586E-13,
                            1.10777E-13, 9.14484E-14, 7.61141E-14, 6.37695E-14, 5.37164E-14, 4.54578E-14,
                            3.86196E-14, 3.29270E-14, 2.81662E-14, 2.41680E-14, 2.07992E-14, 1.79513E-14,
                            1.55365E-14, 1.34830E-14, 1.17314E-14, 1.02327E-14, 8.94653E-15, 7.83930E-15,
                            6.88317E-15, 6.05501E-15, 5.33559E-15, 4.70888E-15, 4.16147E-15, 3.68217E-15,
                            3.26154E-15, 2.89165E-15, 2.56578E-15, 2.27821E-15, 2.02408E-15, 1.79921E-15,
                            1.60001E-15, 1.42339E-15, 1.26665E-15, 1.12747E-15, 1.00379E-15, 8.93851E-16,
                            7.96070E-16, 7.09075E-16, 6.31653E-16, 5.62734E-16, 5.01371E-16, 4.46725E-16,
                            3.98055E-16, 3.54702E-16, 3.16081E-16, 2.81673E-16, 2.51016E-16, 2.23700E-16])
    cel_data[0] = np.array([8.04787E-11, 3.52758E-11, 1.68863E-11, 8.84199E-12, 5.03733E-12, 3.09413E-12,
                            2.02756E-12, 1.40251E-12, 1.01413E-12, 7.59994E-13, 5.86027E-13, 4.62228E-13,
                            3.71155E-13, 3.02262E-13, 2.48928E-13, 2.06848E-13, 1.73133E-13, 1.45797E-13,
                            1.23398E-13, 1.04905E-13, 8.95413E-14, 7.67040E-14, 6.59318E-14, 5.68533E-14,
                            4.91744E-14, 4.26556E-14, 3.71027E-14, 3.23564E-14, 2.82860E-14, 2.47835E-14,
                            2.17601E-14, 1.91419E-14, 1.68677E-14, 1.48867E-14, 1.31565E-14, 1.16415E-14,
                            1.03119E-14, 9.14267E-15, 8.11253E-15, 7.20345E-15, 6.40003E-15, 5.68909E-15,
                            5.05930E-15, 4.50087E-15, 4.00530E-15, 3.56522E-15, 3.17417E-15, 2.82653E-15,
                            2.51734E-15, 2.24225E-15, 1.99744E-15, 1.77950E-15, 1.58546E-15, 1.41266E-15,
                            1.25875E-15, 1.12166E-15, 9.99531E-16, 8.90724E-16, 7.93779E-16, 7.07399E-16])
    cel_data[0] = np.array([6.42078E-10, 2.53755E-10, 1.08747E-10, 5.10491E-11, 2.62604E-11, 1.47241E-11,
                            8.91613E-12, 5.77045E-12, 3.94913E-12, 2.82987E-12, 2.10488E-12, 1.61323E-12,
                            1.26629E-12, 1.01300E-12, 8.22696E-13, 6.76243E-13, 5.61285E-13, 4.69608E-13,
                            3.95497E-13, 3.34957E-13, 2.85087E-13, 2.43689E-13, 2.09134E-13, 1.80127E-13,
                            1.55669E-13, 1.34955E-13, 1.17340E-13, 1.02304E-13, 8.94203E-14, 7.83416E-14,
                            6.87819E-14, 6.05058E-14, 5.33184E-14, 4.70580E-14, 4.15901E-14, 3.68023E-14,
                            3.26004E-14, 2.89050E-14, 2.56490E-14, 2.27755E-14, 2.02358E-14, 1.79884E-14,
                            1.59974E-14, 1.42318E-14, 1.26650E-14, 1.12736E-14, 1.00372E-14, 8.93794E-15,
                            7.96029E-15, 7.09045E-15, 6.31632E-15, 5.62718E-15, 5.01359E-15, 4.46717E-15,
                            3.98049E-15, 3.54698E-15, 3.16078E-15, 2.81670E-15, 2.51014E-15, 2.23699E-15])
    cel_data[0] = np.array([5.58430E-09, 2.03045E-09, 7.87243E-10, 3.31550E-10, 1.52873E-10, 7.74009E-11,
                            4.27498E-11, 2.55429E-11, 1.63364E-11, 1.10665E-11, 7.86206E-12, 5.80680E-12,
                            4.42536E-12, 3.45837E-12, 2.75755E-12, 2.23439E-12, 1.83404E-12, 1.52135E-12,
                            1.27287E-12, 1.07265E-12, 9.09509E-13, 7.75251E-13, 6.63934E-13, 5.70974E-13,
                            4.92911E-13, 4.26997E-13, 3.71077E-13, 3.23421E-13, 2.82636E-13, 2.47594E-13,
                            2.17373E-13, 1.91219E-13, 1.68510E-13, 1.48731E-13, 1.31457E-13, 1.16330E-13,
                            1.03054E-13, 9.13768E-14, 8.10875E-14, 7.20060E-14, 6.39790E-14, 5.68751E-14,
                            5.05813E-14, 4.50001E-14, 4.00467E-14, 3.56475E-14, 3.17383E-14, 2.82628E-14,
                            2.51716E-14, 2.24212E-14, 1.99734E-14, 1.77943E-14, 1.58541E-14, 1.41262E-14,
                            1.25873E-14, 1.12164E-14, 9.99518E-15, 8.90715E-15, 7.93773E-15, 7.07394E-15])
    cel_data[0] = np.array([5.13046E-08, 1.76458E-08, 6.32154E-09, 2.41284E-09, 9.96605E-10, 4.53674E-10,
                            2.26382E-10, 1.23358E-10, 7.27739E-11, 4.60153E-11, 3.08674E-11, 2.17507E-11,
                            1.59577E-11, 1.20974E-11, 9.41656E-12, 7.48728E-12, 6.05597E-12, 4.96660E-12,
                            4.11931E-12, 3.44842E-12, 2.90932E-12, 2.47064E-12, 2.11007E-12, 1.81101E-12,
                            1.56119E-12, 1.35109E-12, 1.17337E-12, 1.02225E-12, 8.93122E-13, 7.82295E-13,
                            6.86784E-13, 6.04162E-13, 5.32438E-13, 4.69977E-13, 4.15423E-13, 3.67651E-13,
                            3.25717E-13, 2.88831E-13, 2.56325E-13, 2.27631E-13, 2.02266E-13, 1.79815E-13,
                            1.59923E-13, 1.42281E-13, 1.26623E-13, 1.12716E-13, 1.00357E-13, 8.93688E-14,
                            7.95952E-14, 7.08989E-14, 6.31591E-14, 5.62689E-14, 5.01338E-14, 4.46702E-14,
                            3.98038E-14, 3.54690E-14, 3.16072E-14, 2.81666E-14, 2.51011E-14, 2.23696E-14])
    cel_data[0] = np.array([4.82362E-07, 1.61255E-07, 5.49142E-08, 1.94238E-08, 7.27309E-09, 2.98366E-09,
                            1.33641E-09, 6.56144E-10, 3.52497E-10, 2.05419E-10, 1.28555E-10, 8.54834E-11,
                            5.97969E-11, 4.36135E-11, 3.29157E-11, 2.55397E-11, 2.02651E-11, 1.63739E-11,
                            1.34257E-11, 1.11413E-11, 9.33772E-12, 7.89088E-12, 6.71496E-12, 5.74825E-12,
                            4.94615E-12, 4.27502E-12, 3.70954E-12, 3.23007E-12, 2.82118E-12, 2.47075E-12,
                            2.16901E-12, 1.90815E-12, 1.68176E-12, 1.48462E-12, 1.31244E-12, 1.16165E-12,
                            1.02927E-12, 9.12803E-13, 8.10147E-13, 7.19515E-13, 6.39384E-13, 5.68450E-13,
                            5.05591E-13, 4.49837E-13, 4.00347E-13, 3.56388E-13, 3.17320E-13, 2.82582E-13,
                            2.51683E-13, 2.24188E-13, 1.99717E-13, 1.77931E-13, 1.58532E-13, 1.41256E-13,
                            1.25868E-13, 1.12161E-13, 9.99494E-14, 8.90697E-14, 7.93760E-14, 7.07385E-14])
    cel_data[0] = np.array([4.52803E-06, 1.50015E-06, 4.98085E-07, 1.67638E-07, 5.81744E-08, 2.17374E-08,
                            8.75667E-09, 3.85210E-09, 1.87232E-09, 9.96968E-10, 5.75851E-10, 3.57165E-10,
                            2.35526E-10, 1.63589E-10, 1.18657E-10, 8.91877E-11, 6.90122E-11, 5.46765E-11,
                            4.41572E-11, 3.62224E-11, 3.00949E-11, 2.52675E-11, 2.14003E-11, 1.82572E-11,
                            1.56721E-11, 1.35236E-11, 1.17223E-11, 1.02004E-11, 8.90599E-12, 7.79850E-12,
                            6.84601E-12, 6.02320E-12, 5.30928E-12, 4.68769E-12, 4.14474E-12, 3.66915E-12,
                            3.25153E-12, 2.88403E-12, 2.56003E-12, 2.27390E-12, 2.02086E-12, 1.79682E-12,
                            1.59825E-12, 1.42209E-12, 1.26570E-12, 1.12677E-12, 1.00329E-12, 8.93484E-13,
                            7.95804E-13, 7.08883E-13, 6.31515E-13, 5.62634E-13, 5.01298E-13, 4.46673E-13,
                            3.98018E-13, 3.54675E-13, 3.16061E-13, 2.81659E-13, 2.51006E-13, 2.23693E-13])
    cel_data[0] = np.array([4.14989E-05, 1.38005E-05, 4.55521E-06, 1.49877E-06, 4.97484E-07, 1.73901E-07,
                            6.41350E-08, 2.54326E-08, 1.11412E-08, 5.36024E-09, 2.81461E-09, 1.60254E-09,
                            9.81634E-10, 6.41521E-10, 4.42701E-10, 3.19669E-10, 2.39587E-10, 1.85123E-10,
                            1.46634E-10, 1.18515E-10, 9.73725E-11, 8.10797E-11, 6.82579E-11, 5.79843E-11,
                            4.96268E-11, 4.27391E-11, 3.70000E-11, 3.21732E-11, 2.80804E-11, 2.45860E-11,
                            2.15845E-11, 1.89940E-11, 1.67468E-11, 1.47901E-11, 1.30806E-11, 1.15827E-11,
                            1.02669E-11, 9.10858E-12, 8.08688E-12, 7.18426E-12, 6.38576E-12, 5.67854E-12,
                            5.05153E-12, 4.49516E-12, 4.00112E-12, 3.56217E-12, 3.17195E-12, 2.82492E-12,
                            2.51617E-12, 2.24141E-12, 1.99683E-12, 1.77906E-12, 1.58514E-12, 1.41243E-12,
                            1.25859E-12, 1.12154E-12, 9.99447E-13, 8.90664E-13, 7.93736E-13, 7.07368E-13])
    cel_data[0] = np.array([3.64301E-04, 1.22696E-04, 4.07914E-05, 1.33862E-05, 4.36192E-06, 1.46169E-06,
                            5.01851E-07, 1.80746E-07, 7.11133E-08, 3.06557E-08, 1.44963E-08, 7.50654E-09,
                            4.23601E-09, 2.59210E-09, 1.69271E-09, 1.16779E-09, 8.43336E-10, 6.32609E-10,
                            4.89625E-10, 3.88787E-10, 3.15210E-10, 2.59921E-10, 2.17297E-10, 1.83702E-10,
                            1.56719E-10, 1.34694E-10, 1.16471E-10, 1.01221E-10, 8.83317E-11, 7.73496E-11,
                            6.79273E-11, 5.97993E-11, 5.27478E-11, 4.66059E-11, 4.12373E-11, 3.65314E-11,
                            3.23939E-11, 2.87491E-11, 2.55321E-11, 2.26883E-11, 2.01712E-11, 1.79406E-11,
                            1.59622E-11, 1.42061E-11, 1.26462E-11, 1.12599E-11, 1.00272E-11, 8.93073E-12,
                            7.95507E-12, 7.08668E-12, 6.31360E-12, 5.62523E-12, 5.01218E-12, 4.46616E-12,
                            3.97976E-12, 3.54645E-12, 3.16040E-12, 2.81644E-12, 2.50995E-12, 2.23685E-12])
    cel_data[0] = np.array([2.98250E-03, 1.03038E-03, 3.49226E-04, 1.15999E-04, 3.78000E-05, 1.24034E-05,
                            4.05493E-06, 1.35744E-06, 4.89118E-07, 1.91643E-07, 8.21267E-08, 3.85598E-08,
                            1.98465E-08, 1.12411E-08, 6.84665E-09, 4.44747E-09, 3.05509E-09, 2.20184E-09,
                            1.65222E-09, 1.28174E-09, 1.02152E-09, 8.32091E-10, 6.89757E-10, 5.79818E-10,
                            4.92871E-10, 4.22716E-10, 3.65146E-10, 3.17235E-10, 2.76889E-10, 2.42581E-10,
                            2.13172E-10, 1.87802E-10, 1.65783E-10, 1.46589E-10, 1.29794E-10, 1.15062E-10,
                            1.02091E-10, 9.06534E-11, 8.05466E-11, 7.16038E-11, 6.36813E-11, 5.66558E-11,
                            5.04203E-11, 4.48823E-11, 3.99608E-11, 3.55851E-11, 3.16930E-11, 2.82300E-11,
                            2.51479E-11, 2.24041E-11, 1.99611E-11, 1.77854E-11, 1.58477E-11, 1.41216E-11,
                            1.25840E-11, 1.12140E-11, 9.99348E-12, 8.90592E-12, 7.93685E-12, 7.07331E-12])
    cel_data[0] = np.array([2.05375E-02, 7.49175E-03, 2.65121E-03, 9.10679E-04, 3.03685E-04, 1.00458E-04,
                            3.24831E-05, 1.05621E-05, 3.63172E-06, 1.33066E-06, 5.21791E-07, 2.20456E-07,
                            1.01592E-07, 5.19312E-08, 2.88357E-08, 1.73323E-08, 1.11940E-08, 7.69709E-09,
                            5.57842E-09, 4.22030E-09, 3.30403E-09, 2.65827E-09, 2.18519E-09, 1.82685E-09,
                            1.54759E-09, 1.32470E-09, 1.14320E-09, 9.92953E-10, 8.66859E-10, 7.59846E-10,
                            6.68194E-10, 5.89126E-10, 5.20478E-10, 4.60589E-10, 4.08135E-10, 3.62077E-10,
                            3.21474E-10, 2.85630E-10, 2.53922E-10, 2.25837E-10, 2.00933E-10, 1.78829E-10,
                            1.59197E-10, 1.41748E-10, 1.26233E-10, 1.12432E-10, 1.00150E-10, 8.92187E-11,
                            7.94865E-11, 7.08204E-11, 6.31025E-11, 5.62281E-11, 5.01044E-11, 4.46490E-11,
                            3.97886E-11, 3.54580E-11, 3.15993E-11, 2.81610E-11, 2.50971E-11, 2.23667E-11])
    cel_data[0] = np.array([1.03912E-01, 4.06277E-02, 1.54470E-02, 5.61942E-03, 1.97117E-03, 6.78183E-04,
                            2.25209E-04, 7.40536E-05, 2.51129E-05, 8.72758E-06, 3.11615E-06, 1.17155E-06,
                            4.80291E-07, 2.20882E-07, 1.12607E-07, 6.34271E-08, 3.90649E-08, 2.59672E-08,
                            1.83779E-08, 1.36767E-08, 1.05867E-08, 8.45245E-09, 6.91286E-09, 5.76011E-09,
                            4.86952E-09, 4.16319E-09, 3.59066E-09, 3.11819E-09, 2.72250E-09, 2.38710E-09,
                            2.10002E-09, 1.85237E-09, 1.63733E-09, 1.44966E-09, 1.28519E-09, 1.14065E-09,
                            1.01317E-09, 9.00551E-10, 8.00870E-10, 7.12525E-10, 6.34141E-10, 5.64533E-10,
                            5.02676E-10, 4.47676E-10, 3.98749E-10, 3.55210E-10, 3.16454E-10, 2.81947E-10,
                            2.51218E-10, 2.23849E-10, 1.99470E-10, 1.77751E-10, 1.58401E-10, 1.41161E-10,
                            1.25799E-10, 1.12111E-10, 9.99134E-11, 8.90437E-11, 7.93572E-11, 7.07249E-11])
    cel_data[0] = np.array([3.39291E-01, 1.46233E-01, 6.15857E-02, 2.41195E-02, 9.03751E-03, 3.30540E-03,
                            1.15444E-03, 3.93335E-04, 1.34025E-04, 4.45070E-05, 1.45594E-05, 4.96915E-06,
                            1.87502E-06, 8.06655E-07, 3.92246E-07, 2.13819E-07, 1.28798E-07, 8.43266E-08,
                            5.90709E-08, 4.36523E-08, 3.36292E-08, 2.67644E-08, 2.18436E-08, 1.81767E-08,
                            1.53537E-08, 1.31206E-08, 1.13138E-08, 9.82472E-09, 8.57863E-09, 7.52293E-09,
                            6.61952E-09, 5.84018E-09, 5.16344E-09, 4.57271E-09, 4.05489E-09, 3.59952E-09,
                            3.19789E-09, 2.84295E-09, 2.52871E-09, 2.25013E-09, 2.00289E-09, 1.78328E-09,
                            1.58808E-09, 1.41447E-09, 1.26001E-09, 1.12253E-09, 1.00014E-09, 8.91144E-10,
                            7.94071E-10, 7.07601E-10, 6.30568E-10, 5.61936E-10, 5.00784E-10, 4.46295E-10,
                            3.97739E-10, 3.54470E-10, 3.15911E-10, 2.81549E-10, 2.50925E-10, 2.23633E-10])
    cel_data[0] = np.array([7.42406E-01, 3.58546E-01, 1.74613E-01, 7.37964E-02, 2.96478E-02, 1.15284E-02,
                            4.26912E-03, 1.51861E-03, 5.26892E-04, 1.71290E-04, 5.34789E-05, 1.74306E-05,
                            6.35417E-06, 2.66525E-06, 1.27494E-06, 6.87842E-07, 4.11445E-07, 2.68153E-07,
                            1.87269E-07, 1.38139E-07, 1.06280E-07, 8.45201E-08, 6.89424E-08, 5.73503E-08,
                            4.84334E-08, 4.13858E-08, 3.56872E-08, 3.09924E-08, 2.70646E-08, 2.37372E-08,
                            2.08899E-08, 1.84333E-08, 1.62998E-08, 1.44372E-08, 1.28042E-08, 1.13677E-08,
                            1.01006E-08, 8.98051E-09, 7.98870E-09, 7.10929E-09, 6.32870E-09, 5.63523E-09,
                            5.01875E-09, 4.47042E-09, 3.98249E-09, 3.54815E-09, 3.16143E-09, 2.81703E-09,
                            2.51027E-09, 2.23699E-09, 1.99352E-09, 1.77660E-09, 1.58330E-09, 1.41106E-09,
                            1.25757E-09, 1.12078E-09, 9.98878E-10, 8.90240E-10, 7.93420E-10, 7.07132E-10])
    cel_data[0] = np.array([1.34620E+00, 7.09801E-01, 3.55553E-01, 1.67698E-01, 7.74786E-02, 3.20814E-02,
                            1.25234E-02, 4.67239E-03, 1.67414E-03, 5.48642E-04, 1.70316E-04, 5.51586E-05,
                            2.00299E-05, 8.38709E-06, 4.01073E-06, 2.16390E-06, 1.29418E-06, 8.43779E-07,
                            5.89442E-07, 4.34833E-07, 3.34618E-07, 2.66188E-07, 2.17161E-07, 1.80678E-07,
                            1.52631E-07, 1.30448E-07, 1.12513E-07, 9.77303E-08, 8.53616E-08, 7.48810E-08,
                            6.59111E-08, 5.81708E-08, 5.14473E-08, 4.55761E-08, 4.04274E-08, 3.58970E-08,
                            3.19000E-08, 2.83661E-08, 2.52362E-08, 2.24605E-08, 1.99963E-08, 1.78067E-08,
                            1.58600E-08, 1.41281E-08, 1.25869E-08, 1.12148E-08, 9.99298E-09, 8.90477E-09,
                            7.93541E-09, 7.07180E-09, 6.30234E-09, 5.61671E-09, 5.00574E-09, 4.46128E-09,
                            3.97608E-09, 3.54366E-09, 3.15829E-09, 2.81484E-09, 2.50874E-09, 2.23593E-09])

    Te_vals, ne_vals = np.meshgrid(-1.2 + (np.linspace(1, 60, 60) - 1) / 10 - 3,
                                   10 + 0.5 * (np.linspace(1, 15, 15) - 1) + 6)

    return Rbf(Te_vals, ne_vals, cel_data)
