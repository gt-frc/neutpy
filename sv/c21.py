import numpy as np
from scipy.interpolate import Rbf


def _calc_svc21_degas():
    """ Calculates cross section for "Continuum n=2 / n=1," whatever that is.

    accepts ne in m^-3 and Te in eV
    results in erg/s, i.e. units of power.
    """

    # populate the 15x60 array to be used for interpolations
    # rows correspond to ne, columns correspond to Te

    c21_data = np.zeros((15, 60))
    c21_data[0] = np.array([5.76221E-10, 2.81357E-10, 1.49512E-10, 8.60758E-11, 5.32204E-11, 3.49745E-11,
                            2.41739E-11, 1.74037E-11, 1.29394E-11, 9.86245E-12, 7.65927E-12, 6.03060E-12,
                            4.79418E-12, 3.83537E-12, 3.07951E-12, 2.47629E-12, 1.99083E-12, 1.59836E-12,
                            1.28000E-12, 1.02174E-12, 8.12527E-13, 6.43457E-13, 5.07335E-13, 3.98197E-13,
                            3.11114E-13, 2.41976E-13, 1.87370E-13, 1.44464E-13, 1.10923E-13, 8.48339E-14,
                            6.46376E-14, 4.90747E-14, 3.71344E-14, 2.80108E-14, 2.10665E-14, 1.58000E-14,
                            1.18195E-14, 8.82036E-15, 6.56739E-15, 4.87958E-15, 3.61838E-15, 2.67821E-15,
                            1.97891E-15, 1.45984E-15, 1.07530E-15, 7.90928E-16, 5.80989E-16, 4.26242E-16,
                            3.12345E-16, 2.28630E-16, 1.67178E-16, 1.22124E-16, 8.91283E-17, 6.49905E-17,
                            4.73504E-17, 3.44710E-17, 2.50761E-17, 1.82287E-17, 1.32421E-17, 9.61349E-18])
    c21_data[0] = np.array([4.19643E-09, 1.83068E-09, 8.71321E-10, 4.53008E-10, 2.55835E-10, 1.55500E-10,
                            1.00637E-10, 6.86115E-11, 4.87907E-11, 3.58728E-11, 2.70647E-11, 2.08225E-11,
                            1.62514E-11, 1.28124E-11, 1.01687E-11, 8.10188E-12, 6.46611E-12, 5.16120E-12,
                            4.11399E-12, 3.27164E-12, 2.59398E-12, 2.04922E-12, 1.61258E-12, 1.26368E-12,
                            9.86067E-13, 7.66149E-13, 5.92759E-13, 4.56713E-13, 3.50483E-13, 2.67928E-13,
                            2.04068E-13, 1.54889E-13, 1.17174E-13, 8.83684E-14, 6.64500E-14, 4.98316E-14,
                            3.72736E-14, 2.78136E-14, 2.07080E-14, 1.53854E-14, 1.14085E-14, 8.44408E-15,
                            6.23924E-15, 4.60271E-15, 3.39034E-15, 2.49380E-15, 1.83191E-15, 1.34403E-15,
                            9.84931E-16, 7.20984E-16, 5.27224E-16, 3.85160E-16, 2.81116E-16, 2.04998E-16,
                            1.49367E-16, 1.08748E-16, 7.91153E-17, 5.75167E-17, 4.17864E-17, 3.03386E-17])
    c21_data[0] = np.array([3.42472E-08, 1.34650E-08, 5.73668E-09, 2.67399E-09, 1.36364E-09, 7.56632E-10,
                            4.52424E-10, 2.88458E-10, 1.94001E-10, 1.36252E-10, 9.90408E-11, 7.39436E-11,
                            5.63366E-11, 4.35679E-11, 3.40511E-11, 2.68004E-11, 2.11822E-11, 1.67766E-11,
                            1.32901E-11, 1.05166E-11, 8.30519E-12, 6.53989E-12, 5.13309E-12, 4.01397E-12,
                            3.12685E-12, 2.42613E-12, 1.87497E-12, 1.44334E-12, 1.10681E-12, 8.45607E-13,
                            6.43750E-13, 4.88419E-13, 3.69377E-13, 2.78501E-13, 2.09381E-13, 1.56993E-13,
                            1.17415E-13, 8.76073E-14, 6.52217E-14, 4.84555E-14, 3.59293E-14, 2.65929E-14,
                            1.96491E-14, 1.44954E-14, 1.06774E-14, 7.85404E-15, 5.76965E-15, 4.23320E-15,
                            3.10230E-15, 2.27103E-15, 1.66079E-15, 1.21334E-15, 8.85633E-16, 6.45870E-16,
                            4.70629E-16, 3.42668E-16, 2.49314E-16, 1.81265E-16, 1.31701E-16, 9.56283E-17])
    c21_data[0] = np.array([3.07782E-07, 1.11228E-07, 4.28393E-08, 1.79036E-08, 8.17961E-09, 4.09782E-09,
                            2.23427E-09, 1.31448E-09, 8.25532E-10, 5.47486E-10, 3.79573E-10, 2.72640E-10,
                            2.01307E-10, 1.51793E-10, 1.16249E-10, 9.00176E-11, 7.02259E-11, 5.50415E-11,
                            4.32405E-11, 3.39886E-11, 2.66974E-11, 2.09319E-11, 1.63718E-11, 1.27659E-11,
                            9.92163E-12, 7.68373E-12, 5.92917E-12, 4.55863E-12, 3.49227E-12, 2.66596E-12,
                            2.02825E-12, 1.53806E-12, 1.16271E-12, 8.76365E-13, 6.58697E-13, 4.93792E-13,
                            3.69253E-13, 2.75483E-13, 2.05076E-13, 1.52351E-13, 1.12965E-13, 8.36102E-14,
                            6.17793E-14, 4.55765E-14, 3.35733E-14, 2.46969E-14, 1.81436E-14, 1.33128E-14,
                            9.75693E-15, 7.14304E-15, 5.22405E-15, 3.81689E-15, 2.78620E-15, 2.03207E-15,
                            1.48084E-15, 1.07830E-15, 7.84602E-16, 5.70497E-16, 4.14540E-16, 3.01025E-16])
    c21_data[0] = np.array([2.97602E-06, 1.01533E-06, 3.60655E-07, 1.36367E-07, 5.57232E-08, 2.50735E-08,
                            1.23388E-08, 6.61330E-09, 3.82687E-09, 2.36563E-09, 1.54580E-09, 1.05698E-09,
                            7.49446E-10, 5.46735E-10, 4.07620E-10, 3.08859E-10, 2.36764E-10, 1.82962E-10,
                            1.42108E-10, 1.10683E-10, 8.62978E-11, 6.72593E-11, 5.23531E-11, 4.06631E-11,
                            3.15031E-11, 2.43341E-11, 1.87380E-11, 1.43822E-11, 1.10028E-11, 8.39009E-12,
                            6.37746E-12, 4.83274E-12, 3.65131E-12, 2.75089E-12, 2.06694E-12, 1.54911E-12,
                            1.15820E-12, 8.63976E-13, 6.43119E-13, 4.77758E-13, 3.54247E-13, 2.62201E-13,
                            1.93749E-13, 1.42944E-13, 1.05307E-13, 7.74723E-14, 5.69211E-14, 4.17705E-14,
                            3.06172E-14, 2.24176E-14, 1.63972E-14, 1.19820E-14, 8.74761E-15, 6.38078E-15,
                            4.65052E-15, 3.38680E-15, 2.46466E-15, 1.79233E-15, 1.30253E-15, 9.45975E-16])
    c21_data[0] = np.array([3.06179E-05, 1.01040E-05, 3.39650E-06, 1.18528E-06, 4.37432E-07, 1.76755E-07,
                            7.78221E-08, 3.74632E-08, 1.96923E-08, 1.11907E-08, 6.80219E-09, 4.37431E-09,
                            2.94603E-09, 2.05967E-09, 1.48266E-09, 1.09156E-09, 8.17283E-10, 6.19529E-10,
                            4.73713E-10, 3.64293E-10, 2.81111E-10, 2.17266E-10, 1.67967E-10, 1.29744E-10,
                            1.00067E-10, 7.70134E-11, 5.91266E-11, 4.52732E-11, 3.45676E-11, 2.63181E-11,
                            1.99797E-11, 1.51258E-11, 1.14193E-11, 8.59827E-12, 6.45767E-12, 4.83843E-12,
                            3.61674E-12, 2.69768E-12, 2.00798E-12, 1.49170E-12, 1.10613E-12, 8.18795E-13,
                            6.05113E-13, 4.46510E-13, 3.29000E-13, 2.42085E-13, 1.77903E-13, 1.30578E-13,
                            9.57329E-14, 7.01105E-14, 5.12933E-14, 3.74903E-14, 2.73766E-14, 1.99739E-14,
                            1.45610E-14, 1.06066E-14, 7.72041E-15, 5.61561E-15, 4.08188E-15, 2.96514E-15])
    c21_data[0] = np.array([3.39649E-04, 1.10070E-04, 3.57654E-05, 1.17806E-05, 3.99886E-06, 1.46076E-06,
                            5.74239E-07, 2.45910E-07, 1.16212E-07, 5.99761E-08, 3.34340E-08, 1.99186E-08,
                            1.25570E-08, 8.30550E-09, 5.70546E-09, 4.03894E-09, 2.92660E-09, 2.15887E-09,
                            1.61401E-09, 1.21842E-09, 9.26006E-10, 7.06858E-10, 5.40956E-10, 4.14435E-10,
                            3.17510E-10, 2.43046E-10, 1.85783E-10, 1.41753E-10, 1.07926E-10, 8.19827E-11,
                            6.21252E-11, 4.69725E-11, 3.54259E-11, 2.66538E-11, 2.00074E-11, 1.49869E-11,
                            1.12009E-11, 8.35463E-12, 6.21919E-12, 4.62089E-12, 3.42726E-12, 2.53769E-12,
                            1.87603E-12, 1.38481E-12, 1.02075E-12, 7.51391E-13, 5.52407E-13, 4.05630E-13,
                            2.97513E-13, 2.17978E-13, 1.59543E-13, 1.16660E-13, 8.52245E-14, 6.22055E-14,
                            4.53663E-14, 3.30593E-14, 2.40729E-14, 1.75167E-14, 1.27373E-14, 9.25597E-15])
    c21_data[0] = np.array([4.05713E-03, 1.30956E-03, 4.19507E-04, 1.33913E-04, 4.30914E-05, 1.45871E-05,
                            5.19850E-06, 1.98603E-06, 8.36565E-07, 3.85526E-07, 1.92909E-07, 1.04070E-07,
                            6.01028E-08, 3.69766E-08, 2.38624E-08, 1.60100E-08, 1.10791E-08, 7.85839E-09,
                            5.68318E-09, 4.17216E-09, 3.09768E-09, 2.31922E-09, 1.74678E-09, 1.32086E-09,
                            1.00123E-09, 7.59844E-10, 5.76800E-10, 4.37663E-10, 3.31751E-10, 2.51125E-10,
                            1.89778E-10, 1.43225E-10, 1.07863E-10, 8.10744E-11, 6.08202E-11, 4.55649E-11,
                            3.40583E-11, 2.54164E-11, 1.89310E-11, 1.40757E-11, 1.04482E-11, 7.74305E-12,
                            5.72947E-12, 4.23341E-12, 3.12354E-12, 2.30155E-12, 1.69372E-12, 1.24490E-12,
                            9.13956E-13, 6.70254E-13, 4.91020E-13, 3.59359E-13, 2.62752E-13, 1.91943E-13,
                            1.40097E-13, 1.02171E-13, 7.44548E-14, 5.42168E-14, 3.94519E-14, 2.86885E-14])
    c21_data[0] = np.array([4.69329E-02, 1.54304E-02, 5.00098E-03, 1.59742E-03, 5.05682E-04, 1.64227E-04,
                            5.44574E-05, 1.88551E-05, 7.09727E-06, 2.90680E-06, 1.29467E-06, 6.25422E-07,
                            3.26700E-07, 1.85160E-07, 1.10897E-07, 6.95351E-08, 4.52626E-08, 3.03959E-08,
                            2.09466E-08, 1.47442E-08, 1.05565E-08, 7.66282E-09, 5.62293E-09, 4.16053E-09,
                            3.09767E-09, 2.31666E-09, 1.73786E-09, 1.30619E-09, 9.82695E-10, 7.39523E-10,
                            5.56362E-10, 4.18542E-10, 3.14471E-10, 2.36005E-10, 1.76889E-10, 1.32675E-10,
                            9.92445E-11, 7.41831E-11, 5.53496E-11, 4.12343E-11, 3.06734E-11, 2.27839E-11,
                            1.68993E-11, 1.25180E-11, 9.25924E-12, 6.83966E-12, 5.04580E-12, 3.71777E-12,
                            2.73596E-12, 2.01109E-12, 1.47662E-12, 1.08303E-12, 7.93537E-13, 5.80850E-13,
                            4.24766E-13, 3.10344E-13, 2.26548E-13, 1.65241E-13, 1.20429E-13, 8.77032E-14])
    c21_data[0] = np.array([4.56247E-01, 1.55750E-01, 5.20996E-02, 1.70564E-02, 5.46877E-03, 1.76179E-03,
                            5.63720E-04, 1.83880E-04, 6.41800E-05, 2.41440E-05, 9.81506E-06, 4.30736E-06,
                            2.04266E-06, 1.06074E-06, 5.82779E-07, 3.36342E-07, 2.02520E-07, 1.26577E-07,
                            8.17244E-08, 5.42594E-08, 3.68729E-08, 2.55609E-08, 1.80161E-08, 1.28727E-08,
                            9.30031E-09, 6.77937E-09, 4.97663E-09, 3.67341E-09, 2.72267E-09, 2.02418E-09,
                            1.50809E-09, 1.12592E-09, 8.41072E-10, 6.28544E-10, 4.69738E-10, 3.52817E-10,
                            2.64111E-10, 1.97952E-10, 1.48161E-10, 1.10796E-10, 8.27817E-11, 6.17881E-11,
                            4.60674E-11, 3.43142E-11, 2.55240E-11, 1.89615E-11, 1.40681E-11, 1.04240E-11,
                            7.71381E-12, 5.70093E-12, 4.20797E-12, 3.10213E-12, 2.28414E-12, 1.67986E-12,
                            1.23404E-12, 9.05531E-13, 6.63767E-13, 4.86052E-13, 3.55567E-13, 2.59865E-13])
    c21_data[0] = np.array([3.38043E+00, 1.22760E+00, 4.32248E-01, 1.47635E-01, 4.89128E-02, 1.60574E-02,
                            5.14413E-03, 1.65262E-03, 5.58930E-04, 1.99898E-04, 7.56147E-05, 3.03213E-05,
                            1.30153E-05, 6.10769E-06, 3.04404E-06, 1.60689E-06, 8.93726E-07, 5.20841E-07,
                            3.16115E-07, 1.98624E-07, 1.28406E-07, 8.50615E-08, 5.75120E-08, 3.95508E-08,
                            2.75848E-08, 1.94653E-08, 1.38695E-08, 9.96245E-09, 7.20371E-09, 5.23761E-09,
                            3.82531E-09, 2.80566E-09, 2.06359E-09, 1.52155E-09, 1.12412E-09, 8.38086E-10,
                            6.23322E-10, 4.65478E-10, 3.47700E-10, 2.59964E-10, 1.94531E-10, 1.45649E-10,
                            1.09082E-10, 8.17411E-11, 6.12222E-11, 4.58371E-11, 3.42992E-11, 2.56470E-11,
                            1.91608E-11, 1.43009E-11, 1.06619E-11, 7.93954E-12, 5.90494E-12, 4.38604E-12,
                            3.25352E-12, 2.41017E-12, 1.78300E-12, 1.31725E-12, 9.71859E-13, 7.16085E-13])
    c21_data[0] = np.array([1.75514E+01, 6.85194E+00, 2.60072E+00, 9.44261E-01, 3.30471E-01, 1.13386E-01,
                            3.75186E-02, 1.22729E-02, 4.12678E-03, 1.41308E-03, 4.91822E-04, 1.77423E-04,
                            6.84079E-05, 2.89866E-05, 1.32687E-05, 6.54148E-06, 3.44547E-06, 1.92125E-06,
                            1.12391E-06, 6.84063E-07, 4.29736E-07, 2.77232E-07, 1.82794E-07, 1.22687E-07,
                            8.35502E-08, 5.75799E-08, 4.00739E-08, 2.81187E-08, 1.98646E-08, 1.41140E-08,
                            1.00769E-08, 7.22638E-09, 5.20029E-09, 3.75404E-09, 2.71748E-09, 1.98315E-09,
                            1.44703E-09, 1.06096E-09, 7.79446E-10, 5.74110E-10, 4.23976E-10, 3.13874E-10,
                            2.32896E-10, 1.73312E-10, 1.29156E-10, 9.64161E-11, 7.20840E-11, 5.39611E-11,
                            4.04361E-11, 3.03250E-11, 2.27547E-11, 1.70795E-11, 1.28208E-11, 9.62262E-12,
                            7.21973E-12, 5.41392E-12, 4.05686E-12, 3.03729E-12, 2.27163E-12, 1.69703E-12])
    c21_data[0] = np.array([5.77965E+01, 2.48978E+01, 1.04798E+01, 4.10160E+00, 1.53564E+00, 5.61076E-01,
                            1.95667E-01, 6.64878E-02, 2.25319E-02, 7.39906E-03, 2.36942E-03, 7.79574E-04,
                            2.77860E-04, 1.10356E-04, 4.82117E-05, 2.29838E-05, 1.18120E-05, 6.46417E-06,
                            3.72495E-06, 2.23847E-06, 1.39025E-06, 8.87374E-07, 5.79084E-07, 3.84686E-07,
                            2.59233E-07, 1.76721E-07, 1.21602E-07, 8.43114E-08, 5.88196E-08, 4.12448E-08,
                            2.90433E-08, 2.05257E-08, 1.45491E-08, 1.03393E-08, 7.36412E-09, 5.26849E-09,
                            3.77269E-09, 2.71000E-09, 1.95028E-09, 1.40662E-09, 1.01685E-09, 7.36812E-10,
                            5.35167E-10, 3.90026E-10, 2.84788E-10, 2.08476E-10, 1.53003E-10, 1.12578E-10,
                            8.30425E-11, 6.14074E-11, 4.55179E-11, 3.38174E-11, 2.51791E-11, 1.87854E-11,
                            1.40412E-11, 1.05125E-11, 7.88210E-12, 5.91714E-12, 4.44648E-12, 3.34389E-12])
    c21_data[0] = np.array([1.26809E+02, 6.12325E+01, 2.98148E+01, 1.25976E+01, 5.05954E+00, 1.96650E+00,
                            7.27625E-01, 2.58354E-01, 8.92411E-02, 2.87242E-02, 8.79175E-03, 2.76681E-03,
                            9.54211E-04, 3.69828E-04, 1.59019E-04, 7.50098E-05, 3.82647E-05, 2.08251E-05,
                            1.19472E-05, 7.15232E-06, 4.42655E-06, 2.81588E-06, 1.83141E-06, 1.21239E-06,
                            8.14035E-07, 5.52782E-07, 3.78788E-07, 2.61450E-07, 1.81516E-07, 1.26613E-07,
                            8.86533E-08, 6.22674E-08, 4.38455E-08, 3.09385E-08, 2.18691E-08, 1.54914E-08,
                            1.09858E-08, 7.80297E-09, 5.54878E-09, 3.95064E-09, 2.81630E-09, 2.01020E-09,
                            1.43670E-09, 1.02928E-09, 7.38021E-10, 5.30020E-10, 3.81282E-10, 2.74774E-10,
                            1.98392E-10, 1.43529E-10, 1.04055E-10, 7.56043E-11, 5.50585E-11, 4.01915E-11,
                            2.94108E-11, 2.15757E-11, 1.58680E-11, 1.16999E-11, 8.64854E-12, 6.40893E-12])
    c21_data[0] = np.array([2.30140E+02, 1.21337E+02, 6.07757E+01, 2.86623E+01, 1.32403E+01, 5.48092E+00,
                            2.13829E+00, 7.96525E-01, 2.84229E-01, 9.22597E-02, 2.80915E-02, 8.78887E-03,
                            3.02156E-03, 1.16925E-03, 5.02684E-04, 2.37204E-04, 1.21057E-04, 6.59032E-05,
                            3.78113E-05, 2.26327E-05, 1.40023E-05, 8.90256E-06, 5.78602E-06, 3.82707E-06,
                            2.56705E-06, 1.74120E-06, 1.19160E-06, 8.21291E-07, 5.69282E-07, 3.96393E-07,
                            2.77013E-07, 1.94147E-07, 1.36390E-07, 9.59958E-08, 6.76684E-08, 4.77574E-08,
                            3.37425E-08, 2.38621E-08, 1.68883E-08, 1.19610E-08, 8.47680E-09, 6.01123E-09,
                            4.26536E-09, 3.03157E-09, 2.15468E-09, 1.53254E-09, 1.09085E-09, 7.77091E-10,
                            5.54057E-10, 3.95407E-10, 2.82471E-10, 2.02015E-10, 1.44648E-10, 1.03707E-10,
                            7.44579E-11, 5.35396E-11, 3.85612E-11, 2.78220E-11, 2.01114E-11, 1.45668E-11])

    Te_vals, ne_vals = np.meshgrid(-1.2 + (np.linspace(1, 60, 60) - 1) / 10 - 3,
                                   10 + 0.5 * (np.linspace(1, 15, 15) - 1) + 6)

    return Rbf(Te_vals, ne_vals, c21_data)
