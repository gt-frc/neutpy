import numpy as np
from scipy.interpolate import Rbf


def _calc_svrec_degas():
    """calculates the recombination cross section using degas data

    accepts ne in m^-3 and Te in keV

    """
    # populate the 15x60 array to be used for interpolations
    # rows correspond to ne, columns correspond to Te

    svrec_data = np.zeros((15, 60))
    svrec_data[0] = np.array([5.23562E-11, 2.56421E-11, 1.36798E-11, 7.91489E-12, 4.92355E-12, 3.25884E-12,
                              2.27112E-12, 1.65038E-12, 1.23991E-12, 9.56132E-13, 7.52235E-13, 6.00894E-13,
                              4.85427E-13, 3.95320E-13, 3.23710E-13, 2.65973E-13, 2.18903E-13, 1.80235E-13,
                              1.48263E-13, 1.21742E-13, 9.97055E-14, 8.13860E-14, 6.61766E-14, 5.35806E-14,
                              4.31833E-14, 3.46341E-14, 2.76382E-14, 2.19433E-14, 1.73330E-14, 1.36222E-14,
                              1.06529E-14, 8.29067E-15, 6.42229E-15, 4.95279E-15, 3.80330E-15, 2.90880E-15,
                              2.21619E-15, 1.68242E-15, 1.27288E-15, 9.59983E-16, 7.21847E-16, 5.41275E-16,
                              4.04819E-16, 3.02029E-16, 2.24829E-16, 1.67007E-16, 1.23811E-16, 9.16184E-17,
                              6.76794E-17, 4.99147E-17, 3.67574E-17, 2.70301E-17, 1.98505E-17, 1.45598E-17,
                              1.06668E-17, 7.80603E-18, 5.70660E-18, 4.16773E-18, 3.04103E-18, 2.21698E-18])
    svrec_data[1] = np.array([1.19483E-10, 5.22693E-11, 2.49652E-11, 1.30381E-11, 7.40515E-12, 4.53223E-12,
                              2.95744E-12, 2.03563E-12, 1.46337E-12, 1.08913E-12, 8.32990E-13, 6.50655E-13,
                              5.16415E-13, 4.14752E-13, 3.35944E-13, 2.73682E-13, 2.23754E-13, 1.83272E-13,
                              1.50150E-13, 1.22900E-13, 1.00405E-13, 8.17979E-14, 6.64123E-14, 5.37086E-14,
                              4.32476E-14, 3.46616E-14, 2.76454E-14, 2.19400E-14, 1.73250E-14, 1.36126E-14,
                              1.06434E-14, 8.28216E-15, 6.41503E-15, 4.94682E-15, 3.79850E-15, 2.90502E-15,
                              2.21325E-15, 1.68016E-15, 1.27117E-15, 9.58689E-16, 7.20878E-16, 5.40553E-16,
                              4.04285E-16, 3.01635E-16, 2.24540E-16, 1.66796E-16, 1.23658E-16, 9.15071E-17,
                              6.75989E-17, 4.98568E-17, 3.67159E-17, 2.70004E-17, 1.98294E-17, 1.45448E-17,
                              1.06561E-17, 7.79854E-18, 5.70133E-18, 4.16404E-18, 3.03846E-18, 2.21519E-18])
    svrec_data[2] = np.array([3.04509E-10, 1.20074E-10, 5.13310E-11, 2.40278E-11, 1.23189E-11, 6.88046E-12,
                              4.14747E-12, 2.66989E-12, 1.81578E-12, 1.29162E-12, 9.52439E-13, 7.22552E-13,
                              5.60335E-13, 4.41859E-13, 3.52780E-13, 2.84170E-13, 2.30287E-13, 1.87325E-13,
                              1.52648E-13, 1.24423E-13, 1.01319E-13, 8.23318E-14, 6.67143E-14, 5.38695E-14,
                              4.33259E-14, 3.46926E-14, 2.76507E-14, 2.19324E-14, 1.73119E-14, 1.35981E-14,
                              1.06296E-14, 8.26995E-15, 6.40474E-15, 4.93842E-15, 3.79181E-15, 2.89977E-15,
                              2.20919E-15, 1.67706E-15, 1.26882E-15, 9.56918E-16, 7.19553E-16, 5.39568E-16,
                              4.03555E-16, 3.01098E-16, 2.24145E-16, 1.66507E-16, 1.23447E-16, 9.13535E-17,
                              6.74874E-17, 4.97761E-17, 3.66576E-17, 2.69583E-17, 1.97992E-17, 1.45231E-17,
                              1.06406E-17, 7.78743E-18, 5.69341E-18, 4.15841E-18, 3.03446E-18, 2.21236E-18])
    svrec_data[3] = np.array([8.49060E-10, 3.07929E-10, 1.19057E-10, 4.99814E-11, 2.29598E-11, 1.15764E-11,
                              6.36225E-12, 3.77936E-12, 2.40078E-12, 1.61343E-12, 1.13563E-12, 8.29673E-13,
                              6.24257E-13, 4.80563E-13, 3.76446E-13, 2.98721E-13, 2.39248E-13, 1.92829E-13,
                              1.56011E-13, 1.26455E-13, 1.02527E-13, 8.30329E-14, 6.71062E-14, 5.40751E-14,
                              4.34228E-14, 3.47276E-14, 2.76528E-14, 2.19184E-14, 1.72914E-14, 1.35765E-14,
                              1.06094E-14, 8.25238E-15, 6.39009E-15, 4.92655E-15, 3.78239E-15, 2.89243E-15,
                              2.20354E-15, 1.67275E-15, 1.26556E-15, 9.54473E-16, 7.17730E-16, 5.38216E-16,
                              4.02557E-16, 3.00363E-16, 2.23607E-16, 1.66114E-16, 1.23160E-16, 9.11453E-17,
                              6.73365E-17, 4.96669E-17, 3.65787E-17, 2.69015E-17, 1.97582E-17, 1.44937E-17,
                              1.06195E-17, 7.77230E-18, 5.68258E-18, 4.15067E-18, 3.02893E-18, 2.20842E-18])
    svrec_data[4] = np.array([2.51294E-09, 8.61810E-10, 3.07765E-10, 1.17046E-10, 4.81415E-11, 2.18157E-11,
                              1.08271E-11, 5.86222E-12, 3.43283E-12, 2.15186E-12, 1.42894E-12, 9.95097E-13,
                              7.20098E-13, 5.37220E-13, 4.10418E-13, 3.19276E-13, 2.51737E-13, 2.00413E-13,
                              1.60594E-13, 1.29198E-13, 1.04141E-13, 8.39591E-14, 6.76164E-14, 5.43382E-14,
                              4.35422E-14, 3.47661E-14, 2.76488E-14, 2.18943E-14, 1.72598E-14, 1.35443E-14,
                              1.05799E-14, 8.22700E-15, 6.36907E-15, 4.90961E-15, 3.76901E-15, 2.88203E-15,
                              2.19555E-15, 1.66667E-15, 1.26098E-15, 9.51047E-16, 7.15182E-16, 5.36330E-16,
                              4.01167E-16, 2.99343E-16, 2.22861E-16, 1.65570E-16, 1.22765E-16, 9.08589E-17,
                              6.71293E-17, 4.95173E-17, 3.64709E-17, 2.68239E-17, 1.97025E-17, 1.44538E-17,
                              1.05909E-17, 7.75182E-18, 5.66795E-18, 4.14022E-18, 3.02148E-18, 2.20311E-18])
    svrec_data[5] = np.array([7.66327E-09, 2.55311E-09, 8.66270E-10, 3.05161E-10, 1.13729E-10, 4.64171E-11,
                              2.06645E-11, 1.00730E-11, 5.36784E-12, 3.09866E-12, 1.91780E-12, 1.25884E-12,
                              8.67441E-13, 6.21778E-13, 4.59922E-13, 3.48653E-13, 2.69302E-13, 2.10936E-13,
                              1.66877E-13, 1.32915E-13, 1.06301E-13, 8.51821E-14, 6.82782E-14, 5.46705E-14,
                              4.36849E-14, 3.48042E-14, 2.76325E-14, 2.18534E-14, 1.72108E-14, 1.34958E-14,
                              1.05363E-14, 8.18990E-15, 6.33857E-15, 4.88517E-15, 3.74979E-15, 2.86713E-15,
                              2.18414E-15, 1.65803E-15, 1.25448E-15, 9.46189E-16, 7.11574E-16, 5.33664E-16,
                              3.99207E-16, 2.97907E-16, 2.21813E-16, 1.64807E-16, 1.22211E-16, 9.04581E-17,
                              6.68398E-17, 4.93087E-17, 3.63209E-17, 2.67162E-17, 1.96253E-17, 1.43985E-17,
                              1.05513E-17, 7.72360E-18, 5.64782E-18, 4.12588E-18, 3.01127E-18, 2.19585E-18])
    svrec_data[6] = np.array([2.35526E-08, 7.76928E-09, 2.56820E-09, 8.60310E-10, 2.96996E-10, 1.10340E-10,
                              4.41495E-11, 1.92661E-11, 9.28160E-12, 4.89122E-12, 2.79070E-12, 1.70611E-12,
                              1.10638E-12, 7.53847E-13, 5.34848E-13, 3.91962E-13, 2.94623E-13, 2.25810E-13,
                              1.75600E-13, 1.37984E-13, 1.09194E-13, 8.67828E-14, 6.91185E-14, 5.50716E-14,
                              4.38386E-14, 3.48251E-14, 2.75875E-14, 2.17807E-14, 1.71313E-14, 1.34205E-14,
                              1.04698E-14, 8.13443E-15, 6.29343E-15, 4.84925E-15, 3.72171E-15, 2.84547E-15,
                              2.16761E-15, 1.64554E-15, 1.24511E-15, 9.39205E-16, 7.06397E-16, 5.29846E-16,
                              3.96403E-16, 2.95856E-16, 2.20317E-16, 1.63721E-16, 1.21424E-16, 8.98889E-17,
                              6.64294E-17, 4.90133E-17, 3.61087E-17, 2.65641E-17, 1.95164E-17, 1.43207E-17,
                              1.04958E-17, 7.68401E-18, 5.61963E-18, 4.10583E-18, 2.99702E-18, 2.18574E-18])
    svrec_data[7] = np.array([7.18560E-08, 2.37459E-08, 7.78945E-09, 2.54694E-09, 8.39929E-10, 2.91582E-10,
                              1.06702E-10, 4.19319E-11, 1.81855E-11, 8.64739E-12, 4.47779E-12, 2.50788E-12,
                              1.50716E-12, 9.64047E-13, 6.49039E-13, 4.55634E-13, 3.30723E-13, 2.46448E-13,
                              1.87395E-13, 1.44659E-13, 1.12888E-13, 8.87463E-14, 7.00865E-14, 5.54796E-14,
                              4.39423E-14, 3.47741E-14, 2.74669E-14, 2.16377E-14, 1.69906E-14, 1.32937E-14,
                              1.03614E-14, 8.04572E-15, 6.22226E-15, 4.79321E-15, 3.67823E-15, 2.81228E-15,
                              2.14245E-15, 1.62667E-15, 1.23104E-15, 9.28776E-16, 6.98708E-16, 5.24203E-16,
                              3.92278E-16, 2.92851E-16, 2.18135E-16, 1.62140E-16, 1.20282E-16, 8.90661E-17,
                              6.58375E-17, 4.85883E-17, 3.58041E-17, 2.63460E-17, 1.93606E-17, 1.42094E-17,
                              1.04165E-17, 7.62758E-18, 5.57951E-18, 4.07733E-18, 2.97680E-18, 2.17141E-18])
    svrec_data[8] = np.array([2.14888E-07, 7.17547E-08, 2.36556E-08, 7.69847E-09, 2.48750E-09, 8.26315E-10,
                              2.81038E-10, 1.00152E-10, 3.89393E-11, 1.65547E-11, 7.70001E-12, 3.90978E-12,
                              2.15684E-12, 1.28766E-12, 8.17223E-13, 5.45754E-13, 3.79913E-13, 2.73514E-13,
                              2.02243E-13, 1.52669E-13, 1.17055E-13, 9.07630E-14, 7.09188E-14, 5.56811E-14,
                              4.38280E-14, 3.45213E-14, 2.71715E-14, 2.13494E-14, 1.67323E-14, 1.30736E-14,
                              1.01799E-14, 7.89978E-15, 6.10686E-15, 4.70321E-15, 3.60883E-15, 2.75988E-15,
                              2.10292E-15, 1.59717E-15, 1.20913E-15, 9.12587E-16, 6.86804E-16, 5.15488E-16,
                              3.85924E-16, 2.88235E-16, 2.14793E-16, 1.59727E-16, 1.18545E-16, 8.78183E-17,
                              6.49434E-17, 4.79490E-17, 3.53478E-17, 2.60209E-17, 1.91293E-17, 1.40451E-17,
                              1.02999E-17, 7.54490E-18, 5.52095E-18, 4.03589E-18, 2.94750E-18, 2.15069E-18])
    svrec_data[9] = np.array([6.20599E-07, 2.11431E-07, 7.07279E-08, 2.32039E-08, 7.47208E-09, 2.42354E-09,
                              7.83075E-10, 2.58931E-10, 9.20545E-11, 3.55144E-11, 1.49398E-11, 6.85836E-12,
                              3.43706E-12, 1.89085E-12, 1.11290E-12, 6.95061E-13, 4.56783E-13, 3.13474E-13,
                              2.22962E-13, 1.63196E-13, 1.22152E-13, 9.29733E-14, 7.16187E-14, 5.56245E-14,
                              4.34261E-14, 3.39951E-14, 2.66354E-14, 2.08578E-14, 1.63072E-14, 1.27193E-14,
                              9.89226E-15, 7.67021E-15, 5.92643E-15, 4.56304E-15, 3.50095E-15, 2.67864E-15,
                              2.04171E-15, 1.55156E-15, 1.17528E-15, 8.87594E-16, 6.68444E-16, 5.02062E-16,
                              3.76144E-16, 2.81135E-16, 2.09655E-16, 1.56021E-16, 1.15878E-16, 8.59037E-17,
                              6.35720E-17, 4.69686E-17, 3.46482E-17, 2.55226E-17, 1.87749E-17, 1.37934E-17,
                              1.01215E-17, 7.41856E-18, 5.43161E-18, 3.97280E-18, 2.90299E-18, 2.11934E-18])
    svrec_data[10] = np.array([1.68084E-06, 5.94727E-07, 2.04616E-07, 6.84781E-08, 2.22914E-08, 7.21033E-09,
                               2.28280E-09, 7.27377E-10, 2.45127E-10, 8.79401E-11, 3.36822E-11, 1.38447E-11,
                               6.17606E-12, 3.04358E-12, 1.61878E-12, 9.26160E-13, 5.66110E-13, 3.66604E-13,
                               2.49165E-13, 1.76084E-13, 1.28362E-13, 9.57634E-14, 7.26464E-14, 5.57629E-14,
                               4.31414E-14, 3.35362E-14, 2.61330E-14, 2.03773E-14, 1.58785E-14, 1.23525E-14,
                               9.58708E-15, 7.42089E-15, 5.72616E-15, 4.40416E-15, 3.37619E-15, 2.58181E-15,
                               1.96708E-15, 1.49452E-15, 1.13198E-15, 8.54932E-16, 6.43962E-16, 4.83819E-16,
                               3.62626E-16, 2.71158E-16, 2.02333E-16, 1.50671E-16, 1.11986E-16, 8.30840E-17,
                               6.15363E-17, 4.55039E-17, 3.35977E-17, 2.47712E-17, 1.82389E-17, 1.34119E-17,
                               9.85052E-18, 7.22648E-18, 5.29566E-18, 3.87672E-18, 2.83518E-18, 2.07153E-18])
    svrec_data[11] = np.array([4.26644E-06, 1.57049E-06, 5.64006E-07, 1.94429E-07, 6.48335E-08, 2.12696E-08,
                               6.75409E-09, 2.12889E-09, 6.93217E-10, 2.31429E-10, 7.92709E-11, 2.84948E-11,
                               1.11125E-11, 4.83580E-12, 2.31651E-12, 1.21811E-12, 6.96709E-13, 4.28456E-13,
                               2.79815E-13, 1.91775E-13, 1.36789E-13, 1.00399E-13, 7.51934E-14, 5.71319E-14,
                               4.38383E-14, 3.38497E-14, 2.62308E-14, 2.03583E-14, 1.58007E-14, 1.22500E-14,
                               9.47927E-15, 7.31767E-15, 5.63305E-15, 4.32321E-15, 3.30761E-15, 2.52399E-15,
                               1.91958E-15, 1.45584E-15, 1.10092E-15, 8.30196E-16, 6.24461E-16, 4.68576E-16,
                               3.50801E-16, 2.62016E-16, 1.95329E-16, 1.45339E-16, 1.07951E-16, 8.00468E-17,
                               5.92629E-17, 4.38111E-17, 3.23434E-17, 2.38465E-17, 1.75602E-17, 1.29162E-17,
                               9.48990E-18, 6.96526E-18, 5.10719E-18, 3.74125E-18, 2.73815E-18, 2.00226E-18])
    svrec_data[12] = np.array([9.52006E-06, 3.75266E-06, 1.44886E-06, 5.21498E-07, 1.80055E-07, 6.08447E-08,
                               1.96868E-08, 6.22909E-09, 1.97452E-09, 6.10200E-10, 1.85444E-10, 5.85530E-11,
                               2.03072E-11, 7.97119E-12, 3.50663E-12, 1.71714E-12, 9.24936E-13, 5.40677E-13,
                               3.38421E-13, 2.23929E-13, 1.55958E-13, 1.12402E-13, 8.28984E-14, 6.21657E-14,
                               4.71671E-14, 3.60675E-14, 2.77139E-14, 2.13502E-14, 1.64623E-14, 1.26886E-14,
                               9.76730E-15, 7.50409E-15, 5.75153E-15, 4.39660E-15, 3.35145E-15, 2.54803E-15,
                               1.93153E-15, 1.46028E-15, 1.10104E-15, 8.27888E-16, 6.21073E-16, 4.64879E-16,
                               3.47222E-16, 2.58688E-16, 1.92420E-16, 1.42874E-16, 1.05907E-16, 7.83799E-17,
                               5.79217E-17, 4.27441E-17, 3.15027E-17, 2.31896E-17, 1.70509E-17, 1.25239E-17,
                               9.18977E-18, 6.73698E-18, 4.93455E-18, 3.61140E-18, 2.64100E-18, 1.92995E-18])
    svrec_data[13] = np.array([1.77710E-05, 7.72350E-06, 3.38849E-06, 1.29160E-06, 4.68588E-07, 1.64759E-07,
                               5.52418E-08, 1.78105E-08, 5.60216E-09, 1.64877E-09, 4.64186E-10, 1.35458E-10,
                               4.37594E-11, 1.60734E-11, 6.64369E-12, 3.06124E-12, 1.55215E-12, 8.55141E-13,
                               5.05819E-13, 3.17693E-13, 2.13257E-13, 1.49214E-13, 1.07133E-13, 7.84093E-14,
                               5.81956E-14, 4.36248E-14, 3.29243E-14, 2.49555E-14, 1.89609E-14, 1.44201E-14,
                               1.09653E-14, 8.33043E-15, 6.31927E-15, 4.78475E-15, 3.61537E-15, 2.72604E-15,
                               2.05093E-15, 1.53975E-15, 1.15356E-15, 8.61954E-16, 6.43069E-16, 4.78967E-16,
                               3.56154E-16, 2.64036E-16, 1.95612E-16, 1.44718E-16, 1.06915E-16, 7.88803E-17,
                               5.81227E-17, 4.27759E-17, 3.14452E-17, 2.30909E-17, 1.69388E-17, 1.24138E-17,
                               9.08936E-18, 6.64949E-18, 4.86062E-18, 3.55030E-18, 2.59136E-18, 1.89015E-18])
    svrec_data[14] = np.array([3.04680E-05, 1.43641E-05, 6.43600E-06, 2.71638E-06, 1.12353E-06, 4.16670E-07,
                               1.45733E-07, 4.87156E-08, 1.56243E-08, 4.57029E-09, 1.25906E-09, 3.58390E-10,
                               1.12861E-10, 4.03158E-11, 1.61463E-11, 7.17047E-12, 3.48326E-12, 1.82897E-12,
                               1.02671E-12, 6.10493E-13, 3.92896E-13, 2.65026E-13, 1.83619E-13, 1.29829E-13,
                               9.32299E-14, 6.77112E-14, 4.95903E-14, 3.65290E-14, 2.70132E-14, 2.00232E-14,
                               1.48599E-14, 1.10313E-14, 8.18631E-15, 6.07035E-15, 4.49678E-15, 3.32744E-15,
                               2.45955E-15, 1.81620E-15, 1.33990E-15, 9.85925E-16, 7.25643E-16, 5.33928E-16,
                               3.92707E-16, 2.87575E-16, 2.10977E-16, 1.54735E-16, 1.13420E-16, 8.30876E-17,
                               6.08306E-17, 4.45088E-17, 3.25469E-17, 2.37855E-17, 1.73723E-17, 1.26808E-17,
                               9.25092E-18, 6.74491E-18, 4.91503E-18, 3.57964E-18, 2.60569E-18, 1.89576E-18])

    # data are given in  cm^3/s. Convert to m^3/s
    svrec_data = svrec_data * 1E-6

    Te_vals, ne_vals = np.meshgrid(-1.2 + (np.linspace(1, 60, 60) - 1) / 10 - 3,  # log10(Te in keV)
                                   10 + 0.5 * (np.linspace(1, 15, 15) - 1) + 6)  # log10(n in m^-3)
    # perform 2D interpolation
    # sigv_rec = griddata(np.column_stack((Te_vals.flatten(), ne_vals.flatten())),
    #                    svrec_data.flatten(),
    #                    (np.asarray(Te), np.asarray(ne)),
    #                    method='linear',
    #                    rescale=True)

    return Rbf(Te_vals, ne_vals, svrec_data)
